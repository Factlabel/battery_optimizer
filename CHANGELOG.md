# Change Log

バッテリー蓄電最適化システム の変更履歴

## [v2.1.0] - 2024-12-30 🤖

### 🛠️ Critical Bug Fixes
- **データ検証エラー修正**: 全データが削除される問題を完全解決
- **日付形式対応**: `2023/4/1`形式の単桁月日に完全対応
- **pandas自動検出**: より柔軟で確実な日付変換を優先実装
- **変数未定義エラー修正**: `final_rows`, `data_retention_rate`の適切な計算実装

### 🤖 AI機能統合
- **OpenAI GPT-4o統合**: 最適化結果の詳細分析とレポート生成
- **Revenue Details専用タブ**: 時間別・市場別・アクション別・日別の4種収益分析
- **インテリジェントチャット**: 文脈理解型AI分析アシスタント
- **自動エラー報告システム**: 管理者への自動エラー通知機能
- **📊 データ送信デバッグ機能**: AIに送信されるデータ内容を確認可能（NEW!）
- **「データがない」問題の根本解決**: 構造化データ送信とシステムプロンプト改善
- **詳細ログ出力**: AI用データ準備プロセスの透明化
- **💼 託送料金・損失率データ管理**: 全エリア・全電圧区分のデータ表示・編集機能（NEW!）

### 📊 UI/UX大幅向上
- **6タブインターフェース**: Graphs, Revenue Details, Data, Summary, AI Chat, 託送料金・損失率
- **統合設定画面**: ⚙️ボタンからAI・メール・一般設定を一元管理
- **複数エンコーディング対応**: UTF-8, Shift_JIS, CP932, EUC-JP
- **自動データ品質検証**: 7段階の詳細データ検証プロセス

### 📈 パフォーマンス
- **完全精度保証**: Streamlit版と100%同等の精度
- **処理速度**: 1,000スロット 18秒、10,000スロット 2分
- **メモリ最適化**: 大規模データセット対応

### 🔧 Technical Improvements
- **データ検証強化**: NaN値処理、型変換エラー対応
- **エラーハンドリング**: 詳細なログ出力とユーザーフレンドリーなメッセージ
- **設定管理**: 暗号化されたAPI キー保存

## [v2.0.0] - 2024-12-15 🚀

### ⚡ パフォーマンス大革命
- **ソルバー時間制限撤廃**: 30秒制限を削除し完全最適化を保証
- **3段階パフォーマンスモード**: Simple, Basic, Full モード実装
- **デバッグログ最適化**: 90%のオーバーヘッド削減
- **メモリ使用量最適化**: 大規模データセット高速処理

### 🎯 バグ修正・安定性向上
- **Action決定ロジック修正**: "charge actionなのに charge_kWh=0" 問題を完全解決
- **数値精度対応**: 1e-6閾値で浮動小数点誤差を適切処理
- **データ一貫性保証**: actionと実際の充放電量の完全一致

### 🛠️ 使いやすさ向上
- **ワンクリック起動**: `start_app.sh` スクリプト実装
- **日付範囲フィルタ**: 全期間/最近7日/最近30日/期間指定
- **リアルタイム詳細ログ**: 最適化プロセスの完全可視化

### 📊 可視化機能強化
- **動的X軸フォーマット**: データ期間に応じた最適表示
- **インタラクティブチャート**: matplotlib統合
- **データテーブル表示**: フィルタ・ソート機能

## [v1.0.0] - 2024-11-01 🎉

### 🌟 初期リリース
- **Streamlit版**: Webベースの蓄電池最適化アプリケーション
- **PyQt6版**: デスクトップネイティブアプリケーション
- **双方向型アーキテクチャ**: 目的に応じた使い分け可能

### 🔧 基本機能
- **市場対応**: JEPX現物、EPRX1/EPRX3調整力
- **エリア対応**: 日本全国9エリア（北海道〜九州）
- **電圧区分**: 特高圧・高圧・低圧
- **制約条件**: サイクル制限、EPRX1ブロック制約

### 📊 入出力機能
- **CSV入力**: 価格予測データ読み込み
- **結果出力**: 最適化結果、収益サマリー
- **可視化**: バッテリー動作チャート、価格グラフ

### ⚙️ パラメータ設定
- **バッテリー仕様**: 出力・容量・損失率設定
- **市場参加設定**: 地域・電圧・市場選択
- **託送料金**: 地域別自動計算

---

**🏢 Factlabel** | © 2024 | **Battery Optimizer Project** 