# Battery Optimizer Desktop App - 起動方法

## 🚀 ワンクリック起動（推奨）

### macOS / Linux
```bash
./start_app.sh
```

### Windows
```cmd
start_app.bat  # (将来追加予定)
```

## 📋 手動起動

1. **仮想環境の作成とアクティベート**
   ```bash
   python3 -m venv venv
   source venv/bin/activate  # macOS/Linux
   # または
   venv\Scripts\activate  # Windows
   ```

2. **依存関係のインストール**
   ```bash
   pip install -r requirements.txt
   ```

3. **アプリケーションの起動**
   ```bash
   python main.py
   ```

## 🔧 トラブルシューティング

### SoC（バッテリー残量）グラフが表示されない場合

1. **ログを確認**
   - アプリの左下のログエリアでエラーメッセージを確認
   - ターミナルでデバッグ情報を確認

2. **一般的な原因と解決法**
   - **原因**: 最適化が完了していない
     - **解決**: CSVデータを読み込んで「最適化実行」を完了させる
   
   - **原因**: データに`battery_level_kWh`列がない
     - **解決**: 最新のコードで再度最適化を実行
   
   - **原因**: 期間フィルターでデータが除外されている
     - **解決**: 「全期間」を選択して確認

3. **デバッグモード**
   - ターミナルでアプリを起動すると詳細なデバッグ情報が表示されます
   - バッテリー残量の範囲やエラー情報を確認できます

### GUI が表示されない場合

1. **macOS**
   - XQuartz がインストールされているか確認
   - `brew install --cask xquartz`

2. **Python バージョン確認**
   ```bash
   python3 --version
   # Python 3.8以上が推奨
   ```

3. **PyQt6 インストール確認**
   ```bash
   python -c "import PyQt6; print('PyQt6 OK')"
   ```

## 🎯 使用方法

1. **CSVデータの準備**
   - 必須列: `date`, `slot`, `JEPX_prediction`, `JEPX_actual`, `EPRX1_actual`, `EPRX3_actual`, `imbalance`
   - 「テンプレートダウンロード」ボタンでサンプルを取得可能

2. **最適化の実行**
   - 「CSV読み込み」でデータをロード
   - パラメータを設定（バッテリー容量、出力など）
   - 「最適化実行」をクリック

3. **結果の確認**
   - **グラフタブ**: 新しい期間選択機能でバッテリー残量とJEPX価格を表示
   - **テーブルタブ**: 詳細な最適化結果を表形式で表示
   - **サマリータブ**: 総利益や統計情報を表示

## 🆕 新機能: 期間選択

### 利用可能な期間オプション
- **全期間**: 全データを表示
- **最近7日間**: 最新から過去7日分
- **最近30日間**: 最新から過去30日分
- **期間指定**: カスタム日付範囲を選択

### 自動X軸フォーマット
- **1日以下**: 2時間間隔の時刻表示
- **7日以下**: 日付表示
- **7日超**: 週間隔表示

## 💡 ヒント

- **大量データ**: 期間選択機能を使って特定期間にフォーカス
- **詳細分析**: 1日表示で時間単位の動作を確認
- **トレンド把握**: 全期間表示で長期傾向を分析
- **結果保存**: 「結果保存」ボタンでCSVエクスポート可能

## 📞 サポート

問題が発生した場合は、以下の情報と共にお問い合わせください：
- OS とバージョン
- Python バージョン
- エラーメッセージ
- ログの内容（ターミナル出力） 